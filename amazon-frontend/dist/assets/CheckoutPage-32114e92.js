import{r as l,c as ae,b as re,d as te,e as ne,f as le,g as ie,j as e,S as ce}from"./index-87321579.js";import{L as z}from"./LoadingSpinner-d69db682.js";import{C as W,a as de}from"./CreditCardIcon-ef4d52a7.js";import{M as D}from"./MapPinIcon-4e371215.js";const he=()=>{var R;const[y,m]=l.useState(1),[d,w]=l.useState(null),[i,C]=l.useState(null),[k,L]=l.useState("standard"),[M,q]=l.useState(""),[B,S]=l.useState(!1),[r,P]=l.useState("cards"),[$,Y]=l.useState(!1),[f,_]=l.useState(""),[h,V]=l.useState(""),[p,G]=l.useState(""),[b,H]=l.useState(""),u=ae(),{cart:F,getCartTotal:J,getCartItemCount:j,clearCart:Q}=re(),{user:t,isAuthenticated:A}=te(),{processPayment:K,getUserPaymentMethods:X}=ne(),{createOrder:Z}=le(),{showNotification:n}=ie(),x=X(t==null?void 0:t.id);l.useEffect(()=>{var s;if(!A){u("/"),n("error","Please sign in to proceed with checkout");return}if(j()===0){u("/cart"),n("error","Your cart is empty");return}((s=t==null?void 0:t.addresses)==null?void 0:s.length)>0&&w(t.addresses[0]),x.length>0?(C(x.find(a=>a.isDefault)||x[0]),P("cards")):(P("cards"),Y(!0))},[A,t,x,j,u,n]);const N=J(),O=Math.round(N*.08),E={standard:{cost:0,days:"5-7",label:"Standard Shipping (FREE)"},express:{cost:999,days:"2-3",label:"Express Shipping"},overnight:{cost:1999,days:"1",label:"Overnight Shipping"}},v=E[k].cost,I=N+O+v,U=[{id:1,title:"Shipping Address",icon:D},{id:2,title:"Payment Method",icon:de},{id:3,title:"Review Order",icon:W}],ee=async()=>{var a,o,g;let s=null;if(r==="cards"){if(!i&&!$){n("error","Please select a payment method");return}s=i||{type:"card"}}else if(r==="upi"){if(!f){n("error","Please select a UPI payment method");return}s={type:"upi",provider:f}}else if(r==="netbanking"){if(!h){n("error","Please select a bank for net banking");return}s={type:"netbanking",bank:h}}else if(r==="wallets"){if(!p){n("error","Please select a wallet");return}s={type:"wallet",provider:p}}else if(r==="cod"){if(b!=="cod"){n("error","Please confirm Cash on Delivery");return}s={type:"cod"}}if(!d){n("error","Please select a shipping address");return}S(!0);try{let c={success:!0};if(s.type!=="cod"&&(c=await K({amount:I,paymentMethod:s,currency:"INR"}),!c.success)){n("error",((a=c.error)==null?void 0:a.message)||"Payment failed"),S(!1);return}const se={items:F,shippingAddress:d,paymentMethod:s.type,paymentDetails:{transactionId:((o=c.transaction)==null?void 0:o.id)||`${s.type}_${Date.now()}`,method:s.type,provider:s.provider||s.bank||"N/A",last4:s.type==="card"?((g=i==null?void 0:i.cardNumber)==null?void 0:g.slice(-4))||"****":null},shippingMethod:k,shippingCost:v,subtotal:N,tax:O,total:I,notes:M},T=await Z(se,t);T.success?(Q(),n("success","Order placed successfully!"),u(`/order-confirmation/${T.order.id}`)):n("error","Failed to create order")}catch(c){n("error","An error occurred during checkout"),console.error("Checkout error:",c)}finally{S(!1)}};return!A||j()===0?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx(z,{size:"large"})}):e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[e.jsx("div",{className:"mb-8",children:e.jsx("div",{className:"flex items-center justify-between",children:U.map((s,a)=>{const o=s.icon,g=y===s.id,c=y>s.id;return e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`flex items-center justify-center w-10 h-10 rounded-full ${c?"bg-green-500 text-white":g?"bg-orange-500 text-white":"bg-gray-300 text-gray-600"}`,children:c?e.jsx(W,{className:"h-6 w-6"}):e.jsx(o,{className:"h-6 w-6"})}),e.jsx("span",{className:`ml-2 text-sm font-medium ${g?"text-orange-600":"text-gray-600"}`,children:s.title}),a<U.length-1&&e.jsx("div",{className:`w-24 h-0.5 mx-4 ${c?"bg-green-500":"bg-gray-300"}`})]},s.id)})})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[y===1&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Shipping Address"}),((R=t==null?void 0:t.addresses)==null?void 0:R.length)>0?e.jsxs("div",{className:"space-y-3",children:[t.addresses.map(s=>e.jsx("div",{className:`p-4 border rounded-lg cursor-pointer transition-colors ${(d==null?void 0:d.id)===s.id?"border-orange-500 bg-orange-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>w(s),children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:s.fullName}),e.jsx("p",{className:"text-gray-600",children:s.streetAddress}),e.jsxs("p",{className:"text-gray-600",children:[s.city,", ",s.state," ",s.zipCode]}),e.jsx("p",{className:"text-gray-600",children:s.country}),s.phone&&e.jsxs("p",{className:"text-gray-600",children:["Phone: ",s.phone]})]}),e.jsx("input",{type:"radio",checked:(d==null?void 0:d.id)===s.id,onChange:()=>w(s),className:"h-4 w-4 text-orange-600 focus:ring-orange-500"})]})},s.id)),e.jsxs("button",{onClick:()=>u("/addresses"),className:"w-full p-4 border-2 border-dashed border-gray-300 rounded-lg text-gray-600 hover:border-orange-300 hover:text-orange-600 transition-colors flex items-center justify-center space-x-2",children:[e.jsx(D,{className:"h-5 w-5"}),e.jsx("span",{children:"Add a new address"})]})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(D,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No addresses found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Add a shipping address to continue"}),e.jsx("button",{onClick:()=>u("/addresses"),className:"bg-orange-600 text-white px-4 py-2 rounded-md hover:bg-orange-700",children:"Add Address"})]}),d&&e.jsx("div",{className:"mt-6",children:e.jsx("button",{onClick:()=>m(2),className:"w-full bg-orange-600 text-white py-3 px-4 rounded-md hover:bg-orange-700 font-medium",children:"Continue to Payment Method"})})]}),y===2&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Choose Payment Method"}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:[{id:"cards",name:"Credit/Debit Cards",icon:"fas fa-credit-card"},{id:"upi",name:"UPI",icon:"fas fa-mobile-alt"},{id:"netbanking",name:"Net Banking",icon:"fas fa-university"},{id:"wallets",name:"Digital Wallets",icon:"fas fa-wallet"},{id:"cod",name:"Cash on Delivery",icon:"fas fa-money-bill-wave"}].map(s=>e.jsxs("button",{onClick:()=>P(s.id),className:`py-2 px-1 border-b-2 font-medium text-sm whitespace-nowrap ${r===s.id?"border-orange-500 text-orange-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx("i",{className:`${s.icon} mr-2`}),s.name]},s.id))})}),r==="cards"&&e.jsxs("div",{className:"space-y-4",children:[x.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Saved Cards"}),e.jsx("div",{className:"space-y-3",children:x.map(s=>{var a,o,g;return e.jsx("div",{className:`p-4 border rounded-lg cursor-pointer transition-colors ${(i==null?void 0:i.id)===s.id?"border-orange-500 bg-orange-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>C(s),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("i",{className:`fab fa-cc-${(a=s.cardType)==null?void 0:a.toLowerCase()} text-2xl text-gray-600`})}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-gray-900",children:[(o=s.cardType)==null?void 0:o.toUpperCase()," ending in ",(g=s.cardNumber)==null?void 0:g.slice(-4)]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Expires ",s.expiryMonth,"/",s.expiryYear]}),s.isDefault&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Default"})]})]}),e.jsx("input",{type:"radio",checked:(i==null?void 0:i.id)===s.id,onChange:()=>C(s),className:"h-4 w-4 text-orange-600 focus:ring-orange-500"})]})},s.id)})}),e.jsx("div",{className:"mt-4",children:e.jsx("button",{onClick:()=>Y(!0),className:"text-orange-600 hover:text-orange-700 font-medium text-sm",children:"+ Add a new card"})})]}),(x.length===0||$)&&e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:x.length>0?"Add New Card":"Enter Card Details"}),e.jsxs("form",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Card Number"}),e.jsx("input",{type:"text",placeholder:"1234 5678 9012 3456",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Expiry Month"}),e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"",children:"MM"}),Array.from({length:12},(s,a)=>e.jsx("option",{value:String(a+1).padStart(2,"0"),children:String(a+1).padStart(2,"0")},a+1))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Expiry Year"}),e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"",children:"YYYY"}),Array.from({length:10},(s,a)=>e.jsx("option",{value:new Date().getFullYear()+a,children:new Date().getFullYear()+a},a))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"CVV"}),e.jsx("input",{type:"text",placeholder:"123",maxLength:"4",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name on Card"}),e.jsx("input",{type:"text",placeholder:"John Doe",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"saveCard",className:"h-4 w-4 text-orange-600 focus:ring-orange-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"saveCard",className:"ml-2 block text-sm text-gray-700",children:"Save this card for future purchases"})]}),e.jsx("div",{className:"bg-blue-50 p-3 rounded-md",children:e.jsxs("div",{className:"flex",children:[e.jsx("i",{className:"fas fa-shield-alt text-blue-600 mr-2 mt-0.5"}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("p",{className:"font-medium",children:"Your payment information is secure"}),e.jsx("p",{children:"We use SSL encryption to protect your financial data."})]})]})})]})]})]}),r==="upi"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[{name:"Google Pay",icon:"fab fa-google-pay",id:"gpay"},{name:"PhonePe",icon:"fas fa-mobile-alt",id:"phonepe"},{name:"Paytm",icon:"fas fa-wallet",id:"paytm"},{name:"Other UPI Apps",icon:"fas fa-qrcode",id:"other"}].map(s=>e.jsxs("div",{className:`p-4 border rounded-lg cursor-pointer text-center transition-colors ${f===s.id?"border-orange-500 bg-orange-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>_(s.id),children:[e.jsx("i",{className:`${s.icon} text-2xl text-gray-600 mb-2`}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.name})]},s.id))}),f&&e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Enter UPI ID"}),e.jsx("input",{type:"text",placeholder:"example@upi",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"You will be redirected to your UPI app to complete the payment"})]})]}),r==="netbanking"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Choose Your Bank"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:["State Bank of India","HDFC Bank","ICICI Bank","Axis Bank","Punjab National Bank","Bank of Baroda","Canara Bank","Union Bank","Other Banks"].map(s=>e.jsx("div",{className:`p-3 border rounded-lg cursor-pointer text-center transition-colors ${h===s?"border-orange-500 bg-orange-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>V(s),children:e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s})},s))}),h&&e.jsx("div",{className:"bg-blue-50 p-3 rounded-md",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("i",{className:"fas fa-info-circle mr-2"}),"You will be redirected to ",h," to complete your payment securely."]})})]}),r==="wallets"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[{name:"Paytm Wallet",icon:"fas fa-wallet",id:"paytm"},{name:"PhonePe Wallet",icon:"fas fa-mobile-alt",id:"phonepe"},{name:"Amazon Pay",icon:"fab fa-amazon-pay",id:"amazonpay"},{name:"Mobikwik",icon:"fas fa-wallet",id:"mobikwik"}].map(s=>e.jsxs("div",{className:`p-4 border rounded-lg cursor-pointer text-center transition-colors ${p===s.id?"border-orange-500 bg-orange-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>G(s.id),children:[e.jsx("i",{className:`${s.icon} text-2xl text-gray-600 mb-2`}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.name})]},s.id))}),p&&e.jsx("div",{className:"bg-green-50 p-3 rounded-md",children:e.jsxs("p",{className:"text-sm text-green-800",children:[e.jsx("i",{className:"fas fa-check-circle mr-2"}),"Pay securely using your ",p," wallet balance."]})})]}),r==="cod"&&e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"border rounded-lg p-6 text-center",children:[e.jsx("i",{className:"fas fa-money-bill-wave text-4xl text-green-600 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Cash on Delivery"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Pay with cash when your order is delivered to your doorstep."}),e.jsx("div",{className:"bg-yellow-50 p-3 rounded-md",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:[e.jsx("i",{className:"fas fa-exclamation-triangle mr-2"}),"COD charges may apply. Please keep exact change ready."]})}),e.jsx("button",{onClick:()=>H("cod"),className:`mt-4 px-6 py-2 rounded-md font-medium transition-colors ${b==="cod"?"bg-orange-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:b==="cod"?"Selected":"Select COD"})]})})]}),e.jsxs("div",{className:"mt-8 flex space-x-4",children:[e.jsxs("button",{onClick:()=>m(1),className:"flex-1 bg-gray-200 text-gray-900 py-3 px-4 rounded-md hover:bg-gray-300 font-medium",children:[e.jsx("i",{className:"fas fa-arrow-left mr-2"}),"Back to Address"]}),e.jsxs("button",{onClick:()=>{r==="cod"&&b==="cod"||r==="cards"&&(i||$)||r==="upi"&&f||r==="netbanking"&&h||r==="wallets"&&p?m(3):alert("Please select a payment method to continue")},className:"flex-1 bg-orange-600 text-white py-3 px-4 rounded-md hover:bg-orange-700 font-medium",children:["Review Order",e.jsx("i",{className:"fas fa-arrow-right ml-2"})]})]})]}),y===3&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Review Your Order"}),e.jsx("div",{className:"space-y-4 mb-6",children:F.map(s=>e.jsxs("div",{className:"flex items-center space-x-4 py-3 border-b",children:[e.jsx("img",{src:s.image,alt:s.name,className:"w-16 h-16 object-cover rounded"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-gray-900",children:s.name}),e.jsxs("p",{className:"text-gray-600",children:["Quantity: ",s.quantity]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"font-medium text-gray-900",children:["$",(s.price*s.quantity).toFixed(2)]})})]},s.id))}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Shipping Options"}),e.jsx("div",{className:"space-y-2",children:Object.entries(E).map(([s,a])=>e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"shipping",value:s,checked:k===s,onChange:o=>L(o.target.value),className:"h-4 w-4 text-orange-600 focus:ring-orange-500"}),e.jsxs("span",{className:"ml-2 text-sm text-gray-700",children:[a.label," - ",a.days," business days",a.cost>0&&` (+$${(a.cost/100).toFixed(2)})`]})]},s))})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Order Notes (Optional)"}),e.jsx("textarea",{value:M,onChange:s=>q(s.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500",placeholder:"Any special instructions for your order..."})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("button",{onClick:()=>m(2),className:"flex-1 bg-gray-200 text-gray-900 py-3 px-4 rounded-md hover:bg-gray-300 font-medium",children:"Back to Payment"}),e.jsx("button",{onClick:ee,disabled:B,className:"flex-1 bg-orange-600 text-white py-3 px-4 rounded-md hover:bg-orange-700 font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:B?e.jsxs(e.Fragment,{children:[e.jsx(z,{size:"small"}),e.jsx("span",{className:"ml-2",children:"Processing..."})]}):"Place Order"})]})]})]}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 sticky top-4",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Order Summary"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:["Subtotal (",j()," items)"]}),e.jsxs("span",{children:["$",(N/100).toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Shipping"}),e.jsx("span",{children:v===0?"FREE":`$${(v/100).toFixed(2)}`})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Tax"}),e.jsxs("span",{children:["$",(O/100).toFixed(2)]})]}),e.jsx("hr",{className:"my-2"}),e.jsxs("div",{className:"flex justify-between font-bold text-lg",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["$",(I/100).toFixed(2)]})]})]}),e.jsx("div",{className:"mt-6 p-3 bg-green-50 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ce,{className:"h-5 w-5 text-green-600 mr-2"}),e.jsx("span",{className:"text-sm text-green-800",children:"Your payment information is secure and encrypted"})]})})]})})]})]})})};export{he as default};
//# sourceMappingURL=CheckoutPage-32114e92.js.map
